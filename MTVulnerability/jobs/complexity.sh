CUDA="3"
ARCH="resnet18"
MODEL="~/Code/pytorch_output/{dataset}/{arch}_noW/{train}{aux}"

TRAIN="nA+nD+nd+ne+ns+nk+nK+nE+np+nr+n+sA+sd+sD+sn+s+sk+sK+sE+sp+sr+s+dA+de+dD+dn+ds+dk+dK+dE+dp+dr+d+DA+DD+Dd+Dn+Ds+Dk+DK+DE+Dp+Dr+D+EA+Ed+ED+En+Ee+Ek+EK+Es+Ep+Er+E"
TARGET="nA+nD+nd+ne+ns+nk+nK+nE+np+nr+n+sA+sd+sD+sn+s+sk+sK+sE+sp+sr+s+dA+de+dD+dn+ds+dk+dK+dE+dp+dr+d+DA+DD+Dd+Dn+Ds+Dk+DK+DE+Dp+Dr+D+EA+Ed+ED+En+Ee+Ek+EK+Es+Ep+Er+E"

STRATEGY="None"
EPSILON=8
NORM="Linf"
EPOCH=150
STEPS=25
NAME="iccv21-adv-complexity"
BATCH=32
LOG_BATCH=0

CUDA_VISIBLE_DEVICES=$CUDA /home/sghamizi/miniconda3/envs/salah_pytorch/bin/python "./experiments/complexity.py" --store_examples $LOG_BATCH --norm $NORM --arch $ARCH --model_root $MODEL --train_task_set $TRAIN --target_task_set $TARGET --strategy $STRATEGY --epsilon $EPSILON --epoch $EPOCH --steps $STEPS --name $NAME --test_batch_size $BATCH

ARCH="resnet50"
CUDA_VISIBLE_DEVICES=$CUDA /home/sghamizi/miniconda3/envs/salah_pytorch/bin/python "./experiments/complexity.py" --store_examples $LOG_BATCH --norm $NORM --arch $ARCH --model_root $MODEL --train_task_set $TRAIN --target_task_set $TARGET --strategy $STRATEGY --epsilon $EPSILON --epoch $EPOCH --steps $STEPS --name $NAME --test_batch_size $BATCH

ARCH="xception"
CUDA_VISIBLE_DEVICES=$CUDA /home/sghamizi/miniconda3/envs/salah_pytorch/bin/python "./experiments/complexity.py" --store_examples $LOG_BATCH --norm $NORM --arch $ARCH --model_root $MODEL --train_task_set $TRAIN --target_task_set $TARGET --strategy $STRATEGY --epsilon $EPSILON --epoch $EPOCH --steps $STEPS --name $NAME --test_batch_size $BATCH

ARCH="resnet152"
CUDA_VISIBLE_DEVICES=$CUDA /home/sghamizi/miniconda3/envs/salah_pytorch/bin/python "./experiments/complexity.py" --store_examples $LOG_BATCH --norm $NORM --arch $ARCH --model_root $MODEL --train_task_set $TRAIN --target_task_set $TARGET --strategy $STRATEGY --epsilon $EPSILON --epoch $EPOCH --steps $STEPS --name $NAME --test_batch_size $BATCH

ARCH="wresnet50"
CUDA_VISIBLE_DEVICES=$CUDA /home/sghamizi/miniconda3/envs/salah_pytorch/bin/python "./experiments/complexity.py" --store_examples $LOG_BATCH --norm $NORM --arch $ARCH --model_root $MODEL --train_task_set $TRAIN --target_task_set $TARGET --strategy $STRATEGY --epsilon $EPSILON --epoch $EPOCH --steps $STEPS --name $NAME --test_batch_size $BATCH
